<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>Radio Jit Jot - Demo</title>
</head>
<body>
  <h1>ðŸŽµ Radio Jit Jot - Demo Shuffle ðŸŽµ</h1>
  <audio id="player" controls autoplay></audio>
  <div id="info"></div>

  <script>
    // FunciÃ³n para transformar ID de Google Drive en link directo de descarga
    function driveToDirectLink(id) {
      return `https://drive.google.com/uc?export=download&id=${id}`;
    }

    // FunciÃ³n para mezclar (shuffle) el array
    function shuffle(array) {
      for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
      }
      return array;
    }

    const player = document.getElementById('player');
    const info = document.getElementById('info');
    let playlist = [];
    let current = 0;

    // Cargar JSON externo con lista de tracks
    fetch('jitjot_tracks.json')
      .then(response => response.json())
      .then(data => {
        playlist = shuffle(data);
        if (playlist.length > 0) {
          playTrack(0);
        } else {
          info.textContent = "No hay tracks para reproducir.";
        }
      })
      .catch(error => {
        info.textContent = "Error cargando la lista de reproducciÃ³n.";
        console.error('Error:', error);
      });

    function playTrack(index) {
      if (index >= playlist.length) {
        current = 0; // Loop infinito
      } else {
        current = index;
      }
      const track = playlist[current];
      player.src = driveToDirectLink(track.id);
      info.textContent = `ðŸŽ§ Reproduciendo: ${track.title}`;
      player.play();
    }

    player.addEventListener('ended', () => {
      playTrack(current + 1);
    });
  </script>
</body>
</html>
